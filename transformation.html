<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/markdown/transformation.md at 2022-05-24
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>MSBPMN &#x2013; Transformation</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><img src="images/bannerLeft.png"  alt=""/></div>
</div>
          <div class="pull-right"><div id="bannerRight"><img src="images/bannerRight.png"  alt=""/></div>
</div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2022-05-24<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">MSBPMN</li>
    <li><a href="index.html" title="Overview"><span class="none"></span>Overview</a></li>
    <li><a href="faq.html" title="FAQ"><span class="none"></span>FAQ</a></li>
    <li><a href="fhir2bpmn.html" title="Fhir2BPMN"><span class="none"></span>Fhir2BPMN</a></li>
    <li class="active"><a href="#"><span class="none"></span>Transformation</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Transformation</h1>
<p>The transformation is currently implemented in a single direction, transforming HL7&#xae; FHIR&#xae; PlanDefinitions into BPMN. To do so some assumptions and restrictions were defined. These can be found in the restrictions to transformation section.</p><section>
<h2><a name="Concepts"></a>Concepts</h2>

<table border="0" class="table table-striped">
    <thead>
        
<tr class="a">
            
<th>Type</th>
            
<th>HL7 FHIR</th>
            
<th>BPMN</th>
        </tr>
    </thead>
    <tbody>
<!-- - - - - - - - - -  Sequence Flow - - - - - - - - - -->
        
<tr class="b">
            
<th>Sequence Flow</th>
            
<td>
                
<div>
<pre>&lt;action&gt;
    &lt;id value='ad_1'/&gt;
    &lt;title value='Task 1'/&gt;
    &lt;relatedAction&gt;
        &lt;actionId value='ad_2'/&gt;
        &lt;relationship value='before-start'/&gt;
    &lt;/relatedAction&gt;
&lt;/action&gt;

&lt;action&gt;
    &lt;id value='ad_2'/&gt;
    &lt;title value='Task 2'/&gt;
&lt;/action&gt;</pre></div>
            </td>
            
<td>
                
<div>
<pre>&lt;userTask name=&quot;Task 1&quot; id=&quot;id_ad_1&quot;&gt;
    &lt;incoming&gt;sf_start1_ad_1&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_1_ad_2&lt;/outgoing&gt;
&lt;/userTask&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_1&quot; targetRef=&quot;id_ad_2&quot; id=&quot;sf_ad_1_ad_2&quot;/&gt;
&lt;userTask name=&quot;Task 2&quot; id=&quot;id_ad_2&quot;&gt;
    &lt;incoming&gt;sf_ad_1_ad_2&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_2_ad_3&lt;/outgoing&gt;
&lt;/userTask&gt;




</pre></div>
            </td>
        </tr>
<!-- - - - - - - - - -  XOR - - - - - - - - - -->
        
<tr class="a">
            
<th>Exclusive Split</th>
            
<td>

<div>
<pre>&lt;action&gt;
    &lt;id value=&quot;xor_group&quot;/&gt;
    &lt;title value=&quot;Xor_group&quot;/&gt;
    &lt;groupingBehavior value=&quot;logical-group&quot;/&gt;
    &lt;selectionBehavior value=&quot;exactly-one&quot;/&gt;
    &lt;action&gt;
        &lt;id value=&quot;ad_2&quot;/&gt;
        &lt;title value=&quot;Task 2&quot;/&gt;
        &lt;condition&gt;
            &lt;kind value=&quot;applicability&quot;/&gt;
            &lt;expression&gt;
                &lt;description value=&quot;Some short description of the expression&quot;/&gt;
                &lt;language value=&quot;EL&quot;/&gt;
                &lt;expression value=&quot;$name==2&quot; /&gt;
            &lt;/expression&gt;
        &lt;/condition&gt;
        &lt;relatedAction&gt;
            &lt;actionId value=&quot;xor_group&quot;/&gt;
            &lt;relationship value=&quot;before-end&quot;/&gt;
        &lt;/relatedAction&gt;
    &lt;/action&gt;
    &lt;action&gt;
        &lt;id value=&quot;ad_3&quot;/&gt;
        &lt;title value=&quot;Task 3&quot;/&gt;
        &lt;condition&gt;
            ...
        &lt;/condition&gt;
        &lt;relatedAction&gt;
            &lt;actionId value=&quot;xor_group&quot;/&gt;
            &lt;relationship value=&quot;before-end&quot;/&gt;
        &lt;/relatedAction&gt;
    &lt;/action&gt;
    ...
&lt;/action&gt;</pre></div>
            </td>
            
<td>

<div>
<pre>&lt;exclusiveGateway name=&quot;Xor_group&quot; id=&quot;id_xor_group&quot;&gt;
    &lt;incoming&gt;...&lt;/incoming&gt;
    &lt;outgoing&gt;sf_xor_group_ad_2&lt;/outgoing&gt;
    &lt;outgoing&gt;sf_xor_group_ad_3&lt;/outgoing&gt;
&lt;/exclusiveGateway&gt;
&lt;sequenceFlow sourceRef=&quot;id_xor_group&quot; targetRef=&quot;id_ad_2&quot; name=&quot;$name==2&quot; id=&quot;sf_xor_group_ad_2&quot;&gt;
    &lt;conditionExpression id=&quot;sf_xor_group_ad_2_condition&quot;&gt;$name==2&lt;/conditionExpression&gt;
&lt;/sequenceFlow&gt;
&lt;sequenceFlow sourceRef=&quot;id_xor_group&quot; targetRef=&quot;id_ad_3&quot; name=&quot;$name==1&quot; id=&quot;sf_xor_group_ad_3&quot;&gt;
    &lt;conditionExpression id=&quot;sf_xor_group_ad_3_condition&quot;&gt;$name==1&lt;/conditionExpression&gt;
&lt;/sequenceFlow&gt;
&lt;userTask name=&quot;Task 2&quot; id=&quot;id_ad_2&quot;&gt;
    &lt;incoming&gt;sf_xor_group_ad_2&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_2_join_of_xor_group&lt;/outgoing&gt;
&lt;/userTask&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_2&quot; targetRef=&quot;id_join_of_xor_group&quot; id=&quot;sf_ad_2_join_of_xor_group&quot;/&gt;
&lt;userTask name=&quot;Task 3&quot; id=&quot;id_ad_3&quot;&gt;
    &lt;incoming&gt;sf_xor_group_ad_3&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_3_join_of_xor_group&lt;/outgoing&gt;
&lt;/userTask&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_3&quot; targetRef=&quot;id_join_of_xor_group&quot; id=&quot;sf_ad_3_join_of_xor_group&quot;/&gt;
&lt;exclusiveGateway name=&quot;join&quot; id=&quot;id_join_of_xor_group&quot;&gt;
    &lt;incoming&gt;sf_ad_2_join_of_xor_group&lt;/incoming&gt;
    &lt;incoming&gt;sf_ad_3_join_of_xor_group&lt;/incoming&gt;
    &lt;outgoing&gt;...&lt;/outgoing&gt;
&lt;/exclusiveGateway&gt;








</pre></div>
            </td>
        </tr>
<!-- - - - - - - - - -  Parallel - - - - - - - - - -->
        
<tr class="b">
            
<th>Parallel Split</th>
            
<td>

<div>
<pre>&lt;action&gt;
    &lt;id value=&quot;par_group&quot;/&gt;
    &lt;title value=&quot;par_group&quot;/&gt;
    &lt;groupingBehavior value=&quot;logical-group&quot;/&gt;
    &lt;selectionBehavior value=&quot;all&quot;/&gt;
    &lt;action&gt;
        &lt;id value=&quot;ad_2&quot;/&gt;
        &lt;title value=&quot;Task 2&quot;/&gt;
        &lt;relatedAction&gt;
            &lt;actionId value=&quot;par_group&quot;/&gt;
            &lt;relationship value=&quot;before-end&quot;/&gt;
        &lt;/relatedAction&gt;
    &lt;/action&gt;
    &lt;action&gt;
        &lt;id value=&quot;ad_3&quot;/&gt;
        &lt;title value=&quot;Task 3&quot;/&gt;
        &lt;relatedAction&gt;
            &lt;actionId value=&quot;par_group&quot;/&gt;
            &lt;relationship value=&quot;before-end&quot;/&gt;
        &lt;/relatedAction&gt;
    &lt;/action&gt;
&lt;/action&gt;</pre></div>
            </td>
            
<td>

<div>
<pre>&lt;parallelGateway name=&quot;par_group&quot; id=&quot;id_par_group&quot;&gt;
    &lt;incoming&gt;...&lt;/incoming&gt;
    &lt;outgoing&gt;sf_par_group_ad_3&lt;/outgoing&gt;
    &lt;outgoing&gt;sf_par_group_ad_2&lt;/outgoing&gt;
&lt;/parallelGateway&gt;
&lt;sequenceFlow sourceRef=&quot;id_par_group&quot; targetRef=&quot;id_ad_3&quot; id=&quot;sf_par_group_ad_3&quot;/&gt;
&lt;sequenceFlow sourceRef=&quot;id_par_group&quot; targetRef=&quot;id_ad_2&quot; id=&quot;sf_par_group_ad_2&quot;/&gt;
&lt;userTask name=&quot;Task 3&quot; id=&quot;id_ad_3&quot;&gt;
    &lt;incoming&gt;sf_par_group_ad_3&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_3_join_of_par_group&lt;/outgoing&gt;
&lt;/userTask&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_3&quot; targetRef=&quot;id_join_of_par_group&quot; id=&quot;sf_ad_3_join_of_par_group&quot;/&gt;
&lt;userTask name=&quot;Task 2&quot; id=&quot;id_ad_2&quot;&gt;
    &lt;incoming&gt;sf_par_group_ad_2&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_2_join_of_par_group&lt;/outgoing&gt;
&lt;/userTask&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_2&quot; targetRef=&quot;id_join_of_par_group&quot; id=&quot;sf_ad_2_join_of_par_group&quot;/&gt;
&lt;parallelGateway name=&quot;join&quot; id=&quot;id_join_of_par_group&quot;&gt;
    &lt;incoming&gt;sf_ad_2_join_of_par_group&lt;/incoming&gt;
    &lt;incoming&gt;sf_ad_3_join_of_par_group&lt;/incoming&gt;
    &lt;outgoing&gt;...&lt;/outgoing&gt;
&lt;/parallelGateway&gt;</pre></div>
            </td>
        </tr>
<!-- - - - - - - - - -  Data Flow - - - - - - - - - -->
        
<tr class="a">
            
<th>Data Flow</th>
            
<td>

<div>
<pre>&lt;action&gt;
    &lt;id value=&quot;id_1&quot;/&gt;
    &lt;title value=&quot;Titel 1&quot;/&gt;
    &lt;output&gt;
        &lt;id value=&quot;data_elem_1&quot;/&gt;
        &lt;name value=&quot;My Data Elem&quot;/&gt;
        &lt;dataRequirement&gt;
            &lt;type value=&quot;MyType&quot;/&gt;
        &lt;/dataRequirement&gt;
    &lt;/output&gt;
    ...
&lt;/action&gt;
&lt;action&gt;
    &lt;id value=&quot;id_2&quot;/&gt;
    &lt;title value=&quot;Titel 2&quot;/&gt;
    &lt;input&gt;
        &lt;id value=&quot;data_input_1&quot;/&gt;
        &lt;relatedRequirement&gt;
            &lt;requirementId value=&quot;data_elem_1&quot;/&gt;
        &lt;/relatedRequirement&gt;
    &lt;/input&gt;
    ...
&lt;/action&gt;</pre></div>
            </td>
            
<td>

<div>
<pre>&lt;task id=&quot;id_1&quot; name=&quot;Title 1&quot;&gt;
  &lt;dataOutputAssociation id=&quot;df_id1_data_elem_1&quot;&gt;
    &lt;targetRef&gt;data_elem_1&lt;/targetRef&gt;
  &lt;/dataOutputAssociation&gt;
&lt;/task&gt;
&lt;task id=&quot;id_2&quot; name=&quot;Title 2&quot;&gt;
  &lt;property id=&quot;prop_id_2_data_elem_1&quot; name=&quot;prop_My Data Elem&quot; /&gt;
  &lt;dataInputAssociation id=&quot;df_id_2_data_elem_1&quot;&gt;
    &lt;sourceRef&gt;data_elem_1&lt;/sourceRef&gt;
    &lt;targetRef&gt;prop_id_2_data_elem_1&lt;/targetRef&gt;
  &lt;/dataInputAssociation&gt;
&lt;/task&gt;
&lt;dataObjectReference id=&quot;data_elem_1&quot; name=&quot;My Data Elem&quot;/&gt;










</pre></div>
            </td>
        </tr>
<!-- - - - - - - - - -  Trigger - - - - - - - - - -->
        
<tr class="b">
            
<th>Trigger</th>
            
<td>

<div>
<pre>&lt;action&gt;
    &lt;id value='ad_3'/&gt;
    &lt;title value='Put Pizza in Oven'/&gt;
    &lt;trigger&gt;
        &lt;type value=&quot;named-event&quot;/&gt;
        &lt;name value=&quot;oven-to-180&quot;/&gt;
        &lt;condition&gt;
            &lt;language value=&quot;text/cql&quot;/&gt;
            &lt;expression value=&quot;Oven to 180&#xb0;&quot;/&gt;
        &lt;/condition&gt;
    &lt;/trigger&gt;
&lt;/action&gt;




</pre></div>
            </td>
            
<td>

<div>
<pre>&lt;intermediateCatchEvent name=&quot;Put Pizza in Oven&quot; id=&quot;id_ad_3&quot;&gt;
    &lt;incoming&gt;...&lt;/incoming&gt;
    &lt;outgoing&gt;sf_ad_3_ad_3_triggerAction&lt;/outgoing&gt;
    &lt;conditionalEventDefinition id=&quot;event_ad_3&quot;&gt;
        &lt;condition xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
                   xsi:type=&quot;tFormalExpression&quot; 
                   language=&quot;text/cql&quot;&gt;
            Oven to 180&#xb0;
        &lt;/condition&gt;
    &lt;/conditionalEventDefinition&gt;
&lt;/intermediateCatchEvent&gt;
&lt;sequenceFlow sourceRef=&quot;id_ad_3&quot; targetRef=&quot;id_ad_3_triggerAction&quot; id=&quot;sf_ad_3_ad_3_triggerAction&quot;/&gt;
&lt;userTask name=&quot;Put Pizza in Oven&quot; id=&quot;id_ad_3_triggerAction&quot;&gt;
    &lt;incoming&gt;sf_ad_3_ad_3_triggerAction&lt;/incoming&gt;
    &lt;outgoing&gt;...&lt;/outgoing&gt;
&lt;/userTask&gt;</pre></div>
            </td>
        </tr>
<!-- - - - - - - - - -  Actor - - - - - - - - - -->
        
<tr class="a">
            
<th>Actor / <br />Participants</th>
            
<td>

<div>
<pre>&lt;actor&gt;
    &lt;id value=&quot;actor_1&quot;/&gt;
    &lt;label value=&quot;Max Mustermann&quot;/&gt;
    &lt;description value=&quot;Patient&quot;/&gt;
    &lt;options&gt;
        &lt;type value=&quot;patient&quot;/&gt;
    &lt;/options&gt;
    &lt;options&gt;
        &lt;type value=&quot;patient&quot;/&gt;
        &lt;role&gt;
            &lt;coding&gt;
                &lt;system value=&quot;some_system&quot;/&gt;
                &lt;code value=&quot;some_code&quot;/&gt;
            &lt;/coding&gt;
        &lt;/role&gt;
    &lt;/options&gt;
&lt;/actor&gt;
&lt;action&gt;
    &lt;id value=&quot;ad_1&quot; /&gt;
    &lt;title value=&quot;Action 1&quot;/&gt;
    &lt;participant&gt;
        &lt;actor value=&quot;actor_1&quot;/&gt;
        &lt;function&gt;
            &lt;coding&gt;
                &lt;system value=&quot;some_system&quot;/&gt;
                &lt;code value=&quot;some_code&quot;/&gt;
            &lt;/coding&gt;
        &lt;/function&gt;
    &lt;/participant&gt;
&lt;/action&gt;</pre></div>
            </td>
            
<td>

<div>
<pre>&lt;process ...&gt;
    &lt;laneSet&gt;
        &lt;lane name=&quot;Max Mustermann&quot; id=&quot;id_actor_1&quot;&gt;
            &lt;flowNodeRef&gt;id_ad_1&lt;/flowNodeRef&gt;
        &lt;/lane&gt;
    &lt;/laneSet&gt;
    &lt;userTask name=&quot;Action 1&quot; id=&quot;id_ad_1&quot;&gt;
        &lt;incoming&gt;sf_start18_ad_1&lt;/incoming&gt;
        &lt;outgoing&gt;sf_ad_1_ad_2&lt;/outgoing&gt;
    &lt;/userTask&gt;
&lt;/process&gt;



















</pre></div>
            </td>
        </tr>
    </tbody>
</table></section><section>
<h2><a name="Restrictions_to_the_transformation"></a>Restrictions to the transformation</h2><section>
<h3><a name="Related_Actions"></a>Related Actions</h3>
<p>Each action that is not the last action in the process needs to define the next related action.</p>
<p>The relationship must be before-start for normal sequence flow. There is no support to define additional flow behaviour by defining before-end (except gateways) or other relationship types.</p>
<p>The only exception to that rule are parallel or xor gateways, this can be found in the according section.</p></section><section>
<h3><a name="XOR_Gateways"></a>XOR Gateways</h3>
<p>Currently, there is no support to define action with condition without them being surrounded by an xor action. There are also some restriction to the xor-group.</p>
<p>The groupingBehaviour is fixed to logical-group. In addition to that, selectionBehavior is mandatory and restricted to exactly-one or at-most-one. As a final restriction it is defined that every child action of a xor_group must have a condition (with a defined expression.expression value) and must have a relatedAction to the xor-group with a relationship-value: before-end. The transformation will ignore all conditions defined by actions outside an xor-scope.</p></section><section>
<h3><a name="Parallel_Gateway"></a>Parallel Gateway</h3>
<p>A parallel gateway is similar to an xor-gateway. The only difference is, that the selection behaviour must be set to all.</p></section><section>
<h3><a name="ID"></a>ID</h3>
<p>Every action must have an id. In general, it makes sense to assign an id to every element to make them unique. In addition to that, BPMN has the restriction that an ID must start with a letter. To avoid redirecting that restriction to the PlanDefinition, the transformation prefixes every id that is reused from the PlanDefinition with &#x201c;id_&#x201d;.</p></section><section>
<h3><a name="Data_Flow"></a>Data Flow</h3>
<p>Data Flow Elements are a custom defined extensions that are not part of the HL7&#xae; FHIR&#xae; Model. Thus, the normal HL7&#xae; FHIR&#xae; Specification will fail the validation of Data Flow on Action elements, when they are adapted for our transformation. Both input and output can have relatedRequirements, although for input they are mandatory whereas for output the value of the relatedRequirement is ignored. Each output or input element again must have an ID. Every input element must have at least one relatedRequirement. If an input element references an id, an action with this ID (on output) must exist.</p></section><section>
<h3><a name="Events"></a>Events</h3>
<p>Action can define triggers to start at a specific time or on a specific condition. This concept is restricted to the behaviour that only a single trigger is allowed per action. In addition to that, the trigger type periodic is for timed events, whereas the trigger type namedevent is for conditional events. Conditional events must have a condition inside the trigger.</p></section><section>
<h3><a name="Participants"></a>Participants</h3>
<p>Participants are transformed into BPMN swimlanes. To re-identify the same participant, the role of the participant is used. Thus, every participant in the process must have a role. For identification the first coding of a role is used. Therefore, system and code element will be concatenated and are the unique identifier for the participant. Note: Only the process child activities in BPMN can be in different lanes. That means that if a subprocess (or an action with subactions in HL7&#xae; FHIR&#xae;) has assigned a participant, all child elements/actions will be inside the same lane. No matter if they have participants defined or not.</p></section></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2022
<a href="https://aist.fh-hagenberg.at">Advanced Information Systems and Technology</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>